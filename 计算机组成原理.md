# 计算机组成原理与体系结构笔记

## Chapter 1 概论

## Chapter 2 数据的机器层次表示

### 2.1 数值数据的表示
### 2.2 机器数的定点表示与浮点表示

#### 2.2.1 定点表示法



在定点表示法中约定：所有数据的小数点位置固定不变。

通常，把小数点固定在有效数位的最前面或末尾，这就形成了两类定点数。



Attention：

**补码与原码表示法表示范围不一样**，因为原码中零有两种表示方法，故只能映射2<sup>n</sup>-1个数，而补码可以映射2<sup>n</sup>个数。



**定点小数**

![image-20221101203406046](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\image-20221101203406046.png)

极值与表示范围：

![image-20221101203431348](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\image-20221101203431348.png)

![image-20221101203506679](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\image-20221101203506679.png)

![image-20221101203520146](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\image-20221101203520146.png)

![image-20221101203636375](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\image-20221101203636375.png)

### 2.3 非数值数据的表示
### 2.4 十进制数和数串的表示
### 2.5 不同类型的数据表示举例
### 2.6 数据校验码

## Chapter 3 指令系统

### 3.1 指令格式
### 3.2 寻址技术
### 3.3 堆栈与堆栈操作
### 3.4 指令类型
### 3.5 指令系统的发展

## Chapter 4 数值的机器运算

运算器是计算机进行算术运算和逻辑运算的主要部件，运算器的逻辑结构取决于机器的指令系统、数据表示方法和运算方法等。

本章主要讨论数值数据在计算机中实现算术运算和逻辑运算的方法，以及运算部件的基本结构和工作原理。

### 4.1 基本算术运算的实现

### 4.2 定点加减运算

### 4.3 带符号数的移位和舍入操作

### 4.4 定点乘法运算

### 4.5 定点除法运算

### 4.6 规格化浮点运算
### 4.7 十进制整数的加减运算

### 4.8 逻辑运算与实现

### 4.9 运算器的基本组成与实例



## Chapter 5 存储系统和结构

![image-1](.\image\计组\1.png)

### 5.1 存储系统的组成

![](.\image\计组\2.png)

#### 5.1.1 存储器分类



**按照存储器在计算机系统中的作用分类**

1.高速缓冲存储器

2.主存储器

3.辅助存储器



**按照存取方式分类**

1.随机访问存储器（Random Access Memory,**RAM**)

CPU可以对存储器中的内容随机地存取。

2.只读存储器(Read Only Memory,**ROM**)

存储器内容只能随机读出而不能读入

3.顺序存取存储器(**SAM**)

SAM的内容只能按某种顺序存取，存取时间与信息在存储体上的物理位置有关。

**磁带机**就属于这类存储器。

4.直接存取存储器(**DAM**)

当要存取所需的信息时，第一步直接指向整个存储器中的某个小区域（如磁盘上的磁道），第二步在小区域内顺序检索或等待，直至找到目的地后再进行读写操作。

**磁盘机**就属于这样一类存储器。

由于SAM和DAM的存取时间都与存储体的物理位置有关，所以又通常把它们统称为**串行访问存储器**。



**按照存储介质分类**

1.磁芯存储器

用两种不同的剩磁状态表示0和1，信息可以长期存储，但是是破坏性读出。

2.半导体存储器

主要有MOS和双极型(TTL、ECL)两种。半导体存储的信息会因为断电而丢失。

3.磁表面存储器

在金属或者塑料基体上，涂覆一层磁性材料，用磁层存储信息，常见的有磁盘、磁带等，用作辅助存储器

4.光存储器

采用激光技术控制访问的存储器，一般分为只读式，一次写入式，可改写式



**按信息的可保存性分类**

1.易失性存储器

断电后存储信息消失，如半导体RAM

2.非易失性存储器

断电后信息依旧被保存，如ROM、磁芯存储器、磁表面存储器和光存储器



根据读出时信息是否被破坏可以将读出操作分为破坏性读出和非破坏性读出。破坏性读出信息后需要进行一个重写(再生)操作。



#### 5.1.2 存储系统层次结构

由高速缓冲存储器、主存储器、辅助存储器构成的三级存储系统可以分为两个层次



其中高速缓存和主存间称为**Cache-主存存储层次**（Cache存储系统）

Cache存储系统是为解决主存速度不足而提出来的。

由于**Cache存储系统全部用硬件来调度**，因此它对系统程序员和应用程序员都是透明的。



主存和辅助存储器间称为**主存-辅存存储层次**（虚拟存储系统）

虚拟存储系统是为解决主存容量不足而提出来的。

由于虚拟存储系统需要通过操作系统来调度，因此对系统程序员是不透明的，但对应用程序员是透明的。

### 5.2 主存储器的组织

主存储器是整个存储系统的核心，它用来存放计算机运行期间所需要的程序和数据，CPU可直接随机地对它进行访问。

#### 5.2.1 主存储器的基本结构

![image-20221026190107243](.\image\计组\3.png)



存储体是主存储器的核心，程序和数据都存放在存储体中。



地址译码驱动电路实际上包含译码器和驱动器两部分。

译码器将地址总线输入的地址码转换成与之对应的译码输出线上的有效电平，以表示选中了某一单元，并由驱动器提供驱动电流去驱动相应的读、写电路，完成对被选中单元的读、写操作。



I/O和读写电路包括读出放大器、写入电路和读/写控制电路，用以完成被选中存储单元中各位的读出和写入操作。

存储器的读/写操作是在控制器的控制下进行的。半导体存储器芯片中的控制电路，必须接收到来自控制器的读/写命令或写入允许信号后，才能实现正确的读/写操作。


####  5.2.2 主存储器的存储单元



**位**是二进制数的最基本单位，也是**存储器存储信息的最小单位**。



一个二进制数由若干位组成，当这个二进制数作为一个整体存入或取出时，这个数称为存储字。



存放存储字或存储字节的主存空间称为存储单元或主存单元。

大量存储单元的集合构成一个存储体(MB)，程序和数据都存放在存储体中，它是存储器的核心。



一个存储单元有可能放一个字节，也有可能放一个字，这是由计算机的结构决定的。

对于字节编址的计算机，最小寻址单位是一个字节，

对于字编址的计算机，最小寻址单位是一个字。



**存储单元是CPU对主存可访问操作的最小存储单位。**



小端方案与大端方案

![image-20221026193432410](.\image\计组\4.png)

![image-20221026193503410](.\image\计组\5.png)

####  5.2.3 主存储器的主要技术指标

**存储容量**

![image-20221026193610189](.\image\计组\6.png)

注意:

1. 对于字节编址的计算机，常常使用KB/MB/GB作为存储容量的单位

2. 对于字编址的计算机，通常用**字容量×字长**作为存储容量的单位



**存储速度**

![image-20221026193818954](.\image\计组\7.png)

![image-20221026193929882](.\image\计组\8.png)

一般情况下用不到存储时间，用的都是存储周期，也就是相邻两次访问存储器操作之间所需要的最短时间。



**主存带宽**

![image-20221026194306869](.\image\计组\9.png)

为了提高主存带宽，我们可以考虑：1.缩短存取周期 2.增加存储字长 3.增加存储体。

注：**公式要记住**



####  5.2.4 数据在主存中的存放

一般来说，**数据在主存中有三种存放方法**:

不浪费存储器资源的存放方法、从存储字的起始位置开始存放方法、边界对齐的数据存放方法

符合张继老师所说的“三板斧”：两个极端，一个中庸。

一般来说，**读/写的数据有四种不同长度:**

字节（8位）、半字（16位）、单字（32位）和双字（64位）。



**不浪费存储器资源的存放方法**

![image-20221026200417116](.\image\计组\10.png)



**从存储字的起始位置开始存放方法**

![image-20221026200450874](.\image\计组\11.png)



**边界对齐的数据存放方法**

![image-20221026200656115](.\image\计组\12.png)



### 5.3 半导体随机存储器和只读存储器

主存储器通常分为**RAM**和**ROM**两大部分。

RAM(random access memory)可读可写，

ROM(read-only memory)只能读不能写。

下面重点讨论RAM的工作原理与结构，以及ROM的基本类型。

####  5.3.1 RAM记忆单元电路

![image-20221026205641553](.\image\计组\13.png)

常见的有6管SRAM、4管DRAM、1管DRAM

####  5.3.2 动态RAM的刷新

DRAM的存储电路以电容为基础，为了维持MOS型动态记忆单元的存储信息，每隔一定时间必须对存储体中的所有记忆单元的栅极电容补充电荷，这个过程就是刷新。

刷新通常是按**行**进行的。

![image-20221026212030983](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\14.png)

**常见的刷新方式有三种：集中刷新、分散刷新、异步刷新**

同样符合“三板斧原则”



**集中刷新**

![image-20221026212222680](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\15.png)

![image-20221026212243618](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\16.png)



**分散刷新**

![image-20221026212409448](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\17.png)

![image-20221026212437407](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\18.png)



**异步刷新**

![image-20221026212536942](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\19.png)

![image-20221026212608577](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\20.png)



**MOS型动态RAM的刷新要注意几个问题：**

1. 刷新对CPU是透明的。
2. 刷新通常是一行一行地进行的，每一行中各记忆单元同时被刷新，故**刷新操作时仅需要行地址**，不需要列地址。
3. 刷新操作类似于读出操作。
4. 因为所有芯片同时被刷新，所以在考虑刷新问题时，应当从单个芯片的存储容量着手，而不是从整个存储器的容量着手。
5. 值得一提的是，刷新和重写（再生）是两个完全不同的概念，切不可加以混淆。重写是随机的，某个存储单元只有在破坏性读出之后才需要重写。而刷新是定时的，即使许多记忆单元长期未被访问，若不及时补充电荷的话，信息也会丢失。重写一般是按存储单元进行的，而刷新通常以存储体矩阵中的一行为单位进行的。

####  5.3.3 RAM芯片分析



##### **RAM芯片**

![image-20221026213418294](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\21.png)

存储芯片通过**地址线、数据线和控制线**与外部连接。



**地址线**是单向输入的，其数目与芯片容量有关。



**数据线**是双向的，既可输入，也可输出，其数目与数据位数有关。



**控制线**主要有读/写控制线（或写允许线）和片选线两种，

**读/写控制线**是用来决定芯片是进行读操作还是写操作的，**(ROM不能连)**

**片选线**是用来决定 该芯片是否被选中的。



**DRAM芯片把地址线分成相等的两部分，分两次从相同的引脚送入。**

两次输入的地址分别称为行地址和列地址，行地址由**行地址选通信号RAS**送入存储芯片，列地址由**列地址选通信号CAS**送入存储芯片。

由于采用了地址复用技术，**因此，DRAM芯片每增加一条地址线，实际上是增加了两位地址，也即增加了4倍的容量。**





##### 地址译码方式

地址译码电路能把地址线送来的地址信号翻译成对应存储单元的选择信号。

常见的有单译码和双译码两种。

**单译码**

![image-20221026214359110](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\22.png)

字结构的优点是结构简单，

缺点是使用的外围电路多，成本昂贵。更严重的是，当字数大大超过位数时，存储器会形成纵向很长而横向很窄的不合理结构。

所以这种方式只适用于容量不大的存储器。

**双译码**

![image-20221026214510200](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\23.png)

![image-20221026214618211](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\24.png)

![image-20221026215036647](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\25.png)

##### RAM的读/写时序

**(1)SRAM读/写时序**

读周期表示对该芯片进行两次连续读操作的最小间隔时间。

在此期间，地址输入信息不允许改变，片选信号CS在地址有效之后变为有效，使芯片被选中，最后在数据线上得到读出的信号。

写允许信号WE在读周期中保持高电平。

**WE=1、CS=0**

![image-20221026225545757](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\26.png)

写周期与读周期相似，但除了要加地址和片选信号外，还要加一个低电平有效的写入脉冲WE，并提供写入数据。

**WE=0、CS=0**

![image-20221026225901081](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\27.png)

**(2)DRAM读/写时序**

![image-20221026230344356](C:\Users\Administrator\Desktop\github repo\Learing_note\image\计组\28.png)

####  5.3.4 半导体只读存储器

ROM的最大优点是具有非易失性，即使电源断电，ROM中存储的信息也不会丢失。

ROM的类型有:

1.掩膜式ROM（MROM）2.一次可编程ROM（PROM）3.可擦除可编程ROM（EPROM）4.闪速存储器（flash memory）

####  5.3.5 半导体存储器的封装

### 5.4 主存储器的连接与控制

####  5.4.1 主存容量的扩展

####  5.4.2 存储芯片的地址分配和片选

####  5.4.3 主存储器和CPU的连接

####  5.4.4 主存的校验

####  5.4.5 PC系列微型计算机的存储器接口

### 5.5 提高主存读写速度的技术

####  5.5.1 主存与CPU速度的匹配

####  5.5.2 FPM DRAM

####  5.5.3 EDO DRAM

####  5.5.4 SDRAM

####  5.5.5 DDR SDRAM

####  5.5.6 DDR2、DDR3、DDR4和DDR5 SDRAM

####  5.5.7 Rambus DRAM

####  5.5.8 多通道内存技术

### 5.6 多体交叉存储技术

####  5.6.1 并行访问存储器

####  5.6.2 交叉访问存储器

### 5.7 高速缓冲存储器

####  5.7.1 高速缓存工作原理

####  5.7.2 Cache的读写操作

####  5.7.3 地址映像

####  5.7.4 替换算法

####  5.7.5 更新策略

####  5.7.6 微机中的Cache技术的实现

### 5.8 虚拟存储器

####  5.8.1 虚拟存储器的基本概念

####  5.8.2 页式虚拟存储器

####  5.8.3 段式虚拟存储器

####  5.8.4 段页式虚拟存储器

####  5.8.5 快表与慢表



## Chapter 6 中央处理器

### 6.1 中央处理器的功能和组成

####  6.1.1 CPU的功能

####  6.1.2 CPU中的主要寄存器

####  6.1.3 CPU的组成

####  6.1.4 CPU的主要技术参数

### 6.2 控制器的组成和实现方法

####  6.2.1 控制器的基本组成

####  6.2.2 控制器的硬件实现方法

### 6.3 时序系统与控制方式

####  6.3.1 时序系统

####  6.3.2 控制方式

####  6.3.3 指令运行的基本过程

####  6.3.4 指令的微操作序列

### 6.4 微程序控制原理

####  6.4.1 微程序控制的基本概念

####  6.4.2 微指令编码法

####  6.4.3 微程序控制器的组成和工作原理

####  6.4.4 微程序入口地址的形成

####  6.4.5 后继微地址的形成

####  6.4.6 微程序设计

### 6.5 控制单元的设计

####  6.5.1 简单的CPU模型

####  6.5.2 组合逻辑控制单元设计

####  6.5.3 微程序控制单元设计 

### 6.6 流水线技术

####  6.6.1 重叠控制

####  6.6.2 先行控制原理

####  6.6.3 流水工作原理

### 6.7 精简指令系统计算机

####  6.7.1 RISC的特点和优势

####  6.7.2 RISC基本技术

### 6.8 微处理器中的新技术

####  6.8.1 超标量和超流水线技术

####  6.8.2 EPIC的指令级并行处理

####  6.8.3 超线程技术

####  6.8.4 双核与多核技术

####  6.8.5 睿频加速技术

## Chapter 7 总线

## Chapter 8 外部设备

## Chapter 9 输入输出系统



## Attention

#### 1. WE线不能连ROM 

ROM 是read-only memory，没有相应的引脚，不能连WE线。

